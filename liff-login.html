
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>TEVC LINE 登入</title>
    <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
    <style>
      body { font-family: sans-serif; text-align: center; margin-top: 3em; }
      .status { font-size: 1.2em; color: #2c7be5; }
    </style>
  </head>
  <body>
    <h1>登入中，請稍候...</h1>
    <p class="status" id="status">啟動 LINE 授權流程中</p>
    <script>
      async function main() {
        const liffId = "2005677310-ldwxZ767"; // 用戶的 LIFF ID
        await liff.init({ liffId });

        if (!liff.isLoggedIn()) {
          liff.login();
        } else {
          const profile = await liff.getProfile();
          const lineId = profile.userId;
          document.getElementById("status").textContent = "授權成功，登入官網中...";

          // 登入後直接跳轉官網登入 + 導去保固頁
          const loginUrl = "https://www.tevc.com.tw/user/line/bind" +
            "?line_id=" + encodeURIComponent(lineId) +
            "&redirect=" + encodeURIComponent("https://www.tevc.com.tw/item/register?line_id=" + lineId);

          window.location.href = loginUrl;
        }
      }
      main();
    </script>
  </body>
</html>
